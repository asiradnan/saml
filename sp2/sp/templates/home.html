<!DOCTYPE html>
<html>
<head>
    <title>SAML Service Provider</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            line-height: 1.6;
        }
        .header {
            background: #f5f5f5;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 5px;
            text-align: center;
        }
        .info-section {
            background: #e8f4f8;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #007cba;
        }
        .login-section {
            background: #f0f8f0;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
            text-align: center;
        }
        .user-info {
            background: #fff3cd;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #ffc107;
        }
        .btn {
            display: inline-block;
            padding: 10px 20px;
            background: #007cba;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            margin: 5px;
        }
        .btn:hover {
            background: #005a87;
        }
        .btn-logout {
            background: #dc3545;
        }
        .btn-logout:hover {
            background: #c82333;
        }
        code {
            background: #f0f0f0;
            padding: 2px 5px;
            border-radius: 3px;
        }
        h1, h2 {
            color: #333;
        }
        .nav {
            margin-bottom: 20px;
        }
        .nav a {
            margin-right: 15px;
            color: #007cba;
            text-decoration: none;
        }
        .nav a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="nav">
        <a href="/">Home</a>
        {% if user.is_authenticated %}
            <a href="/profile/">Profile</a>
            <a href="/logout/">Logout</a>
        {% endif %}
        <a href="/admin/">Admin</a>
        <a href="/saml2/metadata/">Metadata</a>
    </div>

    <div class="header">
        <h1>üîê SAML Service Provider</h1>
        <p>Django Service Provider demonstrating SAML SSO integration</p>
    </div>

    {% if user.is_authenticated %}
        <div class="user-info">
            <h2>‚úÖ Authenticated User</h2>
            <p><strong>Username:</strong> {{ user.username }}</p>
            <p><strong>Email:</strong> {{ user.email|default:"Not provided" }}</p>
            <p><strong>First Name:</strong> {{ user.first_name|default:"Not provided" }}</p>
            <p><strong>Last Name:</strong> {{ user.last_name|default:"Not provided" }}</p>
            <p><strong>Staff Status:</strong> {{ user.is_staff|yesno:"Yes,No" }}</p>
            <p><strong>Superuser:</strong> {{ user.is_superuser|yesno:"Yes,No" }}</p>
            
            <div style="margin-top: 15px;">
                <a href="/profile/" class="btn">View Full Profile</a>
                <a href="/logout/" class="btn btn-logout">Logout</a>
            </div>
        </div>
    {% else %}
        <div class="login-section">
            <h2>üöÄ SAML Single Sign-On</h2>
            <p>Click the button below to authenticate via SAML IdP</p>
            <a href="{{ login_url }}" class="btn">Login with SAML</a>
        </div>
    {% endif %}

    <div class="info-section">
        <h2>Service Provider Information</h2>
        <p><strong>Entity ID:</strong> <code>{{ sp_entity_id }}</code></p>
        <p><strong>Metadata URL:</strong> <a href="{{ metadata_url }}" target="_blank">{{ metadata_url }}</a></p>
        <p><strong>ACS URL:</strong> <code>http://localhost:8000/saml2/acs/</code></p>
        <p><strong>SLS URL:</strong> <code>http://localhost:8000/saml2/ls/</code></p>
    </div>

    <div class="info-section">
        <h2>Configuration Details</h2>
        <ul>
            <li>‚úÖ SAML 2.0 compliant Service Provider</li>
            <li>‚úÖ Integrated with Django authentication system</li>
            <li>‚úÖ Automatic user creation from SAML attributes</li>
            <li>‚úÖ Support for both POST and Redirect bindings</li>
            <li>‚úÖ Digital signature verification</li>
            <li>‚úÖ Single Logout (SLO) support</li>
        </ul>
    </div>

    <div class="info-section">
        <h2>Identity Provider Configuration</h2>
        <p>This SP is configured to work with:</p>
        <ul>
            <li><strong>IdP Entity ID:</strong> <code>http://localhost:9000/idp/metadata</code></li>
            <li><strong>SSO URL:</strong> <code>http://localhost:9000/idp/sso/redirect/</code></li>
            <li><strong>SLO URL:</strong> <code>http://localhost:9000/idp/slo/redirect/</code></li>
        </ul>
    </div>

    <div class="info-section">
        <h2>Testing the Integration</h2>
        <ol>
            <li>Make sure the IdP is running on <code>http://localhost:9000</code></li>
            <li>Click "Login with SAML" above</li>
            <li>You'll be redirected to the IdP for authentication</li>
            <li>After successful authentication, you'll return here</li>
            <li>Your user profile will display the SAML attributes</li>
        </ol>
    </div>
</body>
</html>
